ios:
  summary: build for iOS
  usage: "[build-number]"
  command: |
    robo build config
    BUILD_NUMBER="${1:-1}" \
    PRODUCT_NAME="{{.build.productName}}" \
    BUNDLE_VERSION="{{.config.version}}" \
    BUNDLE_IDENTIFIER="{{.build.bundleIdentifier}}" \
    BUILD_TARGET=ios \
      CODE_SIGN_IDENTITY="{{.build.iOS.codeSignIdentity}}" \
      PROVISIONING_PROFILE="{{.build.iOS.adhocProvisioningProfile}}" \
    tools/build/build.sh

android:
  summary: build for Android
  usage: "[build-number]"
  command: |
    robo build config
    BUILD_NUMBER="${1:-1}" \
    PRODUCT_NAME="{{.build.productName}}" \
    BUNDLE_VERSION="{{.config.version}}" \
    BUNDLE_IDENTIFIER="{{.build.bundleIdentifier}}" \
    BUILD_TARGET=android \
    tools/build/build.sh

config:
  summary: make Config.production.json
  command: |
    musta -t tools/build/Config.json.mustache \
      "version={{.config.version}}" \
      "webApiServerBaseUri={{.config.webApiServerBaseUri}}" \
      > client/Assets/Resources/Config/Config.production.json

variables:
  config:
    version: 1.0.0
    webApiServerBaseUri: http://localhost:3000/
  build:
    productName: Foo
    bundleIdentifier: com.example.foo
    iOS:
      codeSignIdentity: John Doe (HOGEHOGE)
      adhocProvisioningProfile: tools/build/cert/foo.mobileprovision
