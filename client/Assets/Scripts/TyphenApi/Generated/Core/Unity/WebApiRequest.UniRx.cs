// This file was generated by typhen-api

using UniRx;

namespace TyphenApi
{
    public partial class WebApiRequest<ResponseT, ErrorT>
        where ResponseT : IType, new()
        where ErrorT : class, IType, new()
    {
        public IObservable<WebApiResponse<ResponseT>> Send()
        {
            return SendAsync().ToObservable().SelectMany(Observable.Create<WebApiResponse<ResponseT>>(observer =>
            {
                if (Error == null)
                {
                    observer.OnNext(Response);
                }
                else
                {
                    observer.OnError(Error);
                }
                observer.OnCompleted();
                return Disposable.Empty;
            }));
        }
    }
}
