// This file was generated by typhen-api

using System;
using System.Collections.Generic;

namespace TyphenApi.WebApi.{{#if namespace}}Parts.{{upperCamelCase namespace}}{{else}}Base{{/if}}
{
    public abstract class {{upperCamelCase name}} : TyphenApi.WebApiBase<{{errorTypeName this}}>
    {
        {{#each modules}}
        {{#if functions}}
        public TyphenApi.WebApi.Parts.{{upperCamelCase fullName}} {{upperCamelCase name}} { get; private set; }
        {{/if}}
        {{/each}}

        protected {{upperCamelCase name}}(string baseUri) : base(baseUri)
        {
            {{#each modules}}
            {{#if functions}}
            {{upperCamelCase name}} = new TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}(baseUri);
            {{/if}}
            {{/each}}
        }

        {{#each functions}}
        [Newtonsoft.Json.JsonObject(Newtonsoft.Json.MemberSerialization.OptIn)]
        class {{upperCamelCase name}}RequestBody : TyphenApi.TypeBase<{{upperCamelCase name}}RequestBody>
        {
            {{#each callSignatures.0.parameters}}
            {{#if comment}}
            /// <summary>{{comment}}</summary>
            {{/if}}
            [TyphenApi.QueryStringProperty("{{serializablePropertyName this}}", {{isOptional}})]
            [Newtonsoft.Json.JsonProperty("{{serializablePropertyName this}}")]
            {{#unless isOptional}}
            [Newtonsoft.Json.JsonRequired]
            {{/unless}}
            public {{{typeName type}}}{{{nullableToken type isOptional}}} {{upperCamelCase name}} { get; set; }
            {{/each}}
        }

        {{#if comment}}
        /// <summary>{{comment}}</summary>
        {{/if}}
        public TyphenApi.WebApiRequest<{{{typeName callSignatures.0.returnType}}}, {{errorTypeName this}}> {{upperCamelCase name}}({{#each callSignatures.0.parameters}}{{{typeName type}}}{{{nullableToken type isOptional}}} {{serializablePropertyName this}}{{#if isOptional}} = null{{/if}}{{#unless @last}}, {{/unless}}{{/each}})
        {
            var requestBody = new {{upperCamelCase name}}RequestBody();
            {{#each callSignatures.0.parameters}}
            requestBody.{{upperCamelCase name}} = {{serializablePropertyName this}};
            {{/each}}

            var request = new TyphenApi.WebApiRequest<{{{typeName callSignatures.0.returnType}}}, {{errorTypeName this}}>(this);
            request.Uri = new Uri(BaseUri, "{{uriPath this}}{{uriSuffix this}}");
            request.Method = HttpMethod.{{upperCamelCase (method this)}};
            request.Body = requestBody;
            request.NoAuthenticationRequired = {{#if tagTable.noAuthRequired}}true{{else}}false{{/if}};
            return request;
        }

        {{/each}}
    }
}
