// This file was generated by typhen-api

using System;
using System.Collections.Generic;

namespace TyphenApi.WebApi.{{#if namespace}}Parts.{{upperCamelCase namespace}}{{else}}Base{{/if}}
{
    public abstract class {{upperCamelCase name}} : TyphenApi.WebApiBase<{{errorTypeName this}}>
    {
        {{#each modules}}
        {{#if functions}}
        public TyphenApi.WebApi.Parts.{{upperCamelCase fullName}} {{upperCamelCase name}} { get; private set; }
        {{/if}}
        {{/each}}

        protected {{upperCamelCase name}}(string baseUri) : base(baseUri)
        {
            {{#each modules}}
            {{#if functions}}
            {{upperCamelCase name}} = new TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}(baseUri);
            {{/if}}
            {{/each}}
        }

        {{#each functions}}
        class {{upperCamelCase name}}RequestBody : TyphenApi.TypeBase<{{upperCamelCase name}}RequestBody>
        {
            {{#each callSignatures.0.parameters}}
            {{#if comment}}
            /// <summary>{{comment}}</summary>
            {{/if}}
            {{#if type.isArray}}
            protected static readonly SerializationInfoForInfo<{{upperCamelCase ../name}}RequestBody, {{{typeName type.type}}}> {{lowerCamelCase name}} = new SerializationInfoForList<{{upperCamelCase ../name}}RequestBody, {{{typeName type.type}}}>("{{serializablePropertyName this}}", {{isOptional}}, (x) => x.{{upperCamelCase name}}, (x, v) => x.{{upperCamelCase name}} = v);
            {{else}}
            protected static readonly SerializationInfo<{{upperCamelCase ../name}}RequestBody, {{{typeName type}}}{{{nullableToken type isOptional}}}> {{lowerCamelCase name}} = new SerializationInfo<{{upperCamelCase ../name}}RequestBody, {{{typeName type}}}{{{nullableToken type isOptional}}}>("{{serializablePropertyName this}}", {{isOptional}}, (x) => x.{{upperCamelCase name}}, (x, v) => x.{{upperCamelCase name}} = v);
            {{/if}}
            public {{{typeName type}}}{{{nullableToken type isOptional}}} {{upperCamelCase name}} { get; set; }
            {{/each}}
        }

        {{#if comment}}
        /// <summary>{{comment}}</summary>
        {{/if}}
        public TyphenApi.WebApiRequest<{{{typeName callSignatures.0.returnType}}}, {{errorTypeName this}}> {{upperCamelCase name}}({{#each callSignatures.0.parameters}}{{{typeName type}}}{{{nullableToken type isOptional}}} {{serializablePropertyName this}}{{#if isOptional}} = null{{/if}}{{#unless @last}}, {{/unless}}{{/each}})
        {
            var requestBody = new {{upperCamelCase name}}RequestBody();
            {{#each callSignatures.0.parameters}}
            requestBody.{{upperCamelCase name}} = {{serializablePropertyName this}};
            {{/each}}

            var request = new TyphenApi.WebApiRequest<{{{typeName callSignatures.0.returnType}}}, {{errorTypeName this}}>(this);
            request.Uri = new Uri(BaseUri, "{{uriPath this}}{{uriSuffix this}}");
            request.Method = HttpMethod.{{upperCamelCase (method this)}};
            request.Body = requestBody;
            request.NoAuthenticationRequired = {{#if tagTable.noAuthRequired}}true{{else}}false{{/if}};
            return request;
        }

        {{/each}}
    }
}
