// This file was generated by typhen-api

using System;

namespace TyphenApi.WebApi{{#if namespace}}.Parts.{{upperCamelCase namespace}}{{/if}}
{
    public class {{upperCamelCase name}} : TyphenApi.WebApiBase<{{errorTypeName this}}>
    {
        {{#each modules}}
        public TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}<T> {{upperCamelCase name}} { get; private set; }
        {{#if @last}}

        {{/if}}
        {{/each}}
        public {{upperCamelCase name}}(Uri baseUri, IWebApiController<{{errorTypeName this}}> controller) : base(baseUri, controller)
        {
            {{#each modules}}
            {{upperCamelCase name}} = new TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}<T>(baseUri, Controller);
            {{/each}}
        }
        {{#each functions}}

        class {{upperCamelCase name}}RequestParameters : TyphenApi.TypeBase
        {
            {{#each callSignatures.0.parameters}}
            {{#if comment}}
            /// <summary>{{comment}}</summary>
            {{/if}}
            [TyphenApi.SerializablePropertyAttribute("{{serializablePropertyName this}}", {{isOptional}})]
            public {{{typeName type}}}{{{nullableToken type isOptional}}} {{upperCamelCase name}} { get; set; }
            {{/each}}
        }

        {{#if ../comment}}
        /// <summary>{{../comment}}</summary>
        {{/if}}
        public TyphenApi.WebApiRequest<{{typeName callSignatures.0.returnType}}, {{errorTypeName this}}> {{upperCamelCase name}}({{#each callSignatures.0.parameters}}{{{typeName type}}}{{{nullableToken type isOptional}}} {{serializablePropertyName this}}{{#if isOptional}} = null{{/if}}{{#unless @last}}, {{/unless}}{{/each}})
        {
            var requestBody = new {{upperCamelCase name}}RequestParameters();
            {{#each callSignatures.0.parameters}}
            requestBody.{{upperCamelCase name}} = {{serializablePropertyName this}};
            {{/each}}

            var request = new TyphenApi.WebApiRequest<{{typeName callSignatures.0.returnType}}, {{errorTypeName this}}>(
                Controller, RequestSender, Serializer);
            request.Uri = new Uri(BaseUri, "{{uriPath this}}{{uriSuffix this}}");
            request.Method = HttpMethod.{{upperCamelCase (method callSignatures.[0])}};
            request.Body = requestBody;
            request.NoAuthenticationRequired = {{#if tagTable.noAuthRequired}}true{{else}}false{{/if}};
            return request;
        }
        {{/each}}
    }
}
