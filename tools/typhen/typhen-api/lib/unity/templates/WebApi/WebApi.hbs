// This file was generated by typhen-api

using System;

namespace TyphenApi.WebApi{{#if namespace}}.Parts.{{upperCamelCase namespace}}{{/if}}
{
    public class {{upperCamelCase name}} : TyphenApi.WebApiBase<{{errorTypeName this}}>
    {
        {{#each modules}}
        {{#if functions}}
        public TyphenApi.WebApi.Parts.{{upperCamelCase fullName}} {{upperCamelCase name}} { get; private set; }
        {{#if @last}}

        {{/if}}
        {{/if}}
        {{/each}}
        public {{upperCamelCase name}}(string baseUri) : base(baseUri)
        {
            Controller = new TyphenApi.Controller.WebApi.{{upperCamelCase fullName}}();
            {{#each modules}}
            {{#if functions}}
            {{upperCamelCase name}} = new TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}(baseUri, Controller);
            {{/if}}
            {{/each}}
        }

        public {{upperCamelCase name}}(string baseUri, IWebApiController<{{errorTypeName this}}> controller) : base(baseUri)
        {
            Controller = controller;
            {{#each modules}}
            {{#if functions}}
            {{upperCamelCase name}} = new TyphenApi.WebApi.Parts.{{upperCamelCase fullName}}(baseUri, Controller);
            {{/if}}
            {{/each}}
        }
        {{#each functions}}

        class {{upperCamelCase name}}RequestParameters : TyphenApi.TypeBase<{{upperCamelCase name}}RequestParameters>
        {
            {{#each callSignatures.0.parameters}}
            {{#if comment}}
            /// <summary>{{comment}}</summary>
            {{/if}}
            protected static readonly SerializationInfo<{{upperCamelCase ../name}}RequestParameters, {{{typeName type}}}{{{nullableToken type isOptional}}}> {{lowerCamelCase name}} = new SerializationInfo<{{upperCamelCase ../name}}RequestParameters, {{{typeName type}}}{{{nullableToken type isOptional}}}>("{{serializablePropertyName this}}", {{isOptional}}, (x) => x.{{upperCamelCase name}}, (x, v) => x.{{upperCamelCase name}} = v);
            public {{{typeName type}}}{{{nullableToken type isOptional}}} {{upperCamelCase name}} { get; set; }
            {{/each}}
        }

        {{#if ../comment}}
        /// <summary>{{../comment}}</summary>
        {{/if}}
        public TyphenApi.WebApiRequest<{{typeName callSignatures.0.returnType}}, {{errorTypeName this}}> {{upperCamelCase name}}({{#each callSignatures.0.parameters}}{{{typeName type}}}{{{nullableToken type isOptional}}} {{serializablePropertyName this}}{{#if isOptional}} = null{{/if}}{{#unless @last}}, {{/unless}}{{/each}})
        {
            var requestBody = new {{upperCamelCase name}}RequestParameters();
            {{#each callSignatures.0.parameters}}
            requestBody.{{upperCamelCase name}} = {{serializablePropertyName this}};
            {{/each}}

            var request = new TyphenApi.WebApiRequest<{{typeName callSignatures.0.returnType}}, {{errorTypeName this}}>(Controller);
            request.Uri = new Uri(BaseUri, "{{uriPath this}}{{uriSuffix this}}");
            request.Method = HttpMethod.{{upperCamelCase (method callSignatures.[0])}};
            request.Body = requestBody;
            request.NoAuthenticationRequired = {{#if tagTable.noAuthRequired}}true{{else}}false{{/if}};
            return request;
        }
        {{/each}}
    }
}
